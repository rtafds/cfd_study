＜二次元熱伝導方程式−−−ＡＤＩ法＞

　このプログラムはＡＤＩ法を用いて(2.29)-(2.31) を解くプログラムである。配列Ｕは時間ステップｎ、ｎ＋１でのＵの値、ＵＵはｎ＋1/2 でのＵの値を記憶する二次元配列であり、Ａ、Ｂ、Ｃ、Ｄはトーマス法を用いて三項対角方程式を解く場合に、連立一次方程式の係数や解などを記憶する一次元配列である。プログラムの最初の部分でｘ、ｙ方向の格子数ＭＸ、ＭＹおよび時間間隔ＤＴ、時間ステップ数NLASTを読み込んだり、計算に必要な定数を計算している。次にDO 10のループで初期条件を与える。DO 20 のループで熱伝導方程式を解く。DO 30、　DO 35のループが境界条件である。DO 40 のループでｘ方向を陰的にしてＵn+1/2 に対する方程式を解き、DO 60 のループでｙ方向を陰的にしてＵn+1 に対する方程式を解いている。DO 45、DO 65のループで連立一次方程式の係数を計算している。そのあと、CALL OUTで50ステップごとに計算結果を表示している。この表示プログラムはプログラムLAP.FOR で用いたものである。

　メインプログラムの仕様

　　配列　Ｕ　----  現時点での解を記憶する配列
　　配列　UU  ----  1/2 時間ステップあとでの解を記憶する配列
　　配列　Ａ　----　差分方程式のＵi-1,jまたはＵi,j-1の係数を記憶する配列
　　配列　Ｂ　----　差分方程式のＵi,jの係数を記憶する配列
　　配列　Ｃ　----　差分方程式のＵi+1,jまたはＵi,j+1の係数を記憶する配列
　　配列　Ｄ　----　差分方程式の右辺の値を記憶する配列、サブルーチン
　　　　　　　　　　THOMASを呼んだあとでは近似解が記憶される。
　　変数　NX,NY --  プログラムの配列の大きさを指定するパラメータ
　　変数　KX,KY --  Ｘ、Ｙ方向の格子数
　　変数　MX,MY --  Ｘ、Ｙ方向の格子点数
　　変数　DT  ----  時間間隔
　　変数　NLAST --  計算打ち切りのタイムステップ数
　　変数　DX,DY --  Ｘ、Ｙ方向の格子間隔
　　変数　R1  ----  （時間間隔）／（Ｘ方向格子間隔）**2
　　変数　R2  ----  （時間間隔）／（Ｙ方向格子間隔）**2

　サブルーチン　OUT の仕様（ラプラス方程式の解法(LAP.FOR)と同じ）

