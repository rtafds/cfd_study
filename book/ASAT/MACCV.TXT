＜Ｃａｖｉｔｙ問題、ＭＡＣ法＞

　このプログラムはＣａｖｉｔｙ問題を非保存形ナビエ・ストークス方程式を用いて解くプログラムである。配列Ｕ、Ｖ、Ｐ、Ｒは速度ｕ、ｖ、圧力ｐおよびポアソン方程式(3.40)（または(3.47)）の右辺を記憶する配列である。またＤは  div V を記憶する配列である。なおＲ、Ｄはｕ、ｖの一次的な記憶場所としても用いる。I20、J20はｘ、ｙ方向の格子数である。またＤＴはΔｔ、ＲＥはレイノルズ数であり、ＬＭは全体のタイムステップ数、ＫＭはポアソン方程式の反復回数の上限である。Ａ１、Ａ２、Ａ３は(3.47)を次のように変形したときの係数である。

Ｐi,j＝Ａ１*（Ｐi+1,j＋Ｐi-1,j）＋Ａ２*（Ｐi,j+1＋Ｐi,j-1）−Ａ３*Ｒi,j

ただし、Ｒは(3.47)の右辺に相当する。DO 20 のループでｕ、ｖ、ｐの初期条件（今の場合すべて０）を与えている。DO 30 のループにおいてＭＡＣ法の時間発展的な解法を構成する。DO 40 のループは左右の壁面での速度の境界条件であり、DO 41 のループは上下の壁面での速度の境界条件である。DO 22 のループで div Ｖ の値およびポアソン方程式の右辺の値Ｒを計算している。 div Ｖ の値を記憶する必要はないが、連続の式がどの程度満足されているかということは、ＭＡＣ法の大きなポイントであるから、計算結果の検討のため一応記憶している。DO 50 のループでガウス−ザイデル法を用いて圧力のポアソン方程式を解いている。圧力の境界条件はノイマン条件（微係数に関する条件）であるから、反復ごとに値が変化する。したがって境界条件も反復のループ内に含める必要がある。収束の判定は残差（上式の右辺−左辺）の全格子点での二乗和がEPS より小さいかどうかで行っている。ただし反復回数の上限をもうけ、上限を越えれば収束していなくても次のステップに進むようにしている。DO 60、61 のループで速度ｕ、ｖをひとつの時間ステップ進める。新しいｕをＤ、ｖをＲに一度記憶した後に DO 62、63のループでＤ、ＲをＵ、Ｖに入れ換えている。計算終了後、DO 71 のループで流れ関数を
　　　　ψ　＝　∫ｕ　ｄｙ
から計算し、Ｒに記憶したあと、Ｒの等値線を簡単な表示プログラムＯＵＴ（プログラムLAP.FOR と同じ）を用いて表示している。なお div Ｖ の値Ｄも計算途中で出力するとよい。

　メインプログラムの仕様

　　配列　Ｕ　----  Ｘ方向速度Ｕを記憶する配列
　　配列　Ｖ　----  Ｙ方向速度Ｖを記憶する配列
　　配列　Ｐ　----  圧力Ｐを記憶する配列
　　配列　Ｒ　----  ポアソン方程式の右辺（ソース項）を記憶する配列、
　　　　　　　　　　Ｖの一時記憶場所や計算終了後の流れ関数の記憶場所
　　　　　　　　　　としても用いる。
　　配列　Ｄ　----  div v を記憶する配列、Ｕの一時記憶場所
　　変数　NX,NY --  プログラムの配列の大きさを指定するパラメータ
　　変数　NA,NB --  Ｘ、Ｙ方向の格子数
　　変数　I21,J21-  Ｘ、Ｙ方向の格子点数
　　変数　DT  ----  時間間隔
　　変数　RE  ----  レイノルズ数
　　変数　LM  ----  計算打ち切りのタイムステップ数
　　変数　KM  ----  流れ関数に関するポアソン方程式の近似差分方程式を
　　　　　　　　　　ガウス−ザイデル法で解くときの最大反復回数
　　変数　DX,DY --  Ｘ、Ｙ方向の格子幅
　　変数　XD,YD --  Ｘ、Ｙ方向の格子幅の逆数
　　変数　XDH,YDH-  Ｘ、Ｙ方向の格子幅の逆数の１／２
　　変数　TD  ----  時間間隔の逆数
　　変数　R1  ----  レイノルズ数の逆数
　　変数　I20,I19-  それぞれ I21-1、I21-2
　　変数　J20,J19-  それぞれ J21-1、J21-2
　　変数　A1,A2,A3  ポアソン方程式を差分化したときにでてくる係数
　　変数　DIVV ---  div V の絶対値の各格子点での総和
　　変数　G2  ----  すべての内部格子点での圧力の誤差の二乗和

　サブルーチン　OUT の仕様（ラプラス方程式の解法(LAP.FOR)と同じ）

