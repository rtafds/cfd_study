＜だ円まわりの二次元非圧縮性粘性流体の流れ＞

　このプログラムはだ円まわりの二次元非圧縮性粘性流体の流れの解析プログラムである。一般座標系で書かれているため格子データを変化させることによりいろいろな流れが計算できる。だ円はふつうＯ型格子をとるが、だ円以外ではＣ、Ｈ型格子を用いた方が便利な場合もある。その場合は境界条件を変化させるなどプログラムに若干の修正が必要になる。このプログラムでは外部から座標値を読み込むんで計算することも可能である。
　プログラムの基本的構成はプログラムPO2D.FORとほぼ同様である。異なる部分として流れ関数のポアソン方程式が圧力のポアソン方程式にかわるため、それに付随してポアソン方程式の右辺を計算するサブルーチン RHSと圧力のポアソン方程式がノイマン型なので圧力の境界条件を設定するサブルーチンPRSBC が加わる点である。計算に必要なパラメータの名前はプログラムPO2D.FORと共通にしているため説明は省略する。サブルーチンや配列名も共通にできる部分はそのまま利用している。
　はじめにサブルーチン GRID で格子を読む。ただしだ円まわりの計算を行うときはサブルーチン内で格子を生成する。このときＡ、Ｂはだ円の長軸、短軸でありＨはＸ方向の最小格子幅である。また格子幅は遠方にいくほどＲ倍づつ大きくなるとする。すなわち、格子幅はＨ、ＨＲ、ＨＲ**2、･･･となるものとする。格子線に関しては同心のだ円の周を一方向の格子線とし、だ円上の点とだ円の中心を結ぶ線（角度を当分割する）をもう一方向の格子線としている。サブルーチンMETJでは変換の係数を計算するが、Ｏ型格子も取り扱うため、その場合は周期条件で端の点の値を決める。サブルーチンINITで初期条件（迎角 ALPH の一様流）を与えたのち、方程式を解いて１つの時間ステップすすめるが、このことを指定された回数繰り返すのがDO 10 のループで、圧力のポアソン方程式をノイマン条件のもとで解いたあと、DO 30、DO 40のループでナビエ・ストークス方程式に従ってｕ、ｖを時間発展させる。サブルーチン BC は速度の境界条件である。最後にOUTPで結果をファイルに出力する。サブルーチンOUT2は簡単な計算結果表示プログラムで、プログラムPOTEN.FOR で用いたものとほぼ同じであるが、速度から流れ関数を計算する部分が新たにつけ加わっている。各サブルーチンの内容は基礎式をそのまま書いたものがほとんどである。

　メインプログラムの仕様

　　変数　ISTEP0 -  圧力に関するポアソン方程式の近似差分方程式を
　　　　　　　　　　ＳＯＲ法で解くときの最大反復回数
　　変数　NSTEPS -  計算打ち切りタイムステップ数
　　変数　EPS  ---  反復法の許容最大誤差（収束判定条件）
　　変数　ERR　---  全格子点での流れ関数の最大相対誤差（BBの最大値）
　　変数　CONST --  圧力に関するポアソン方程式の近似差分方程式を
　　　　　　　　　　ＳＯＲ法で解くときの加速係数

　サブルーチン DATA の仕様

　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　ISTEP0 -  圧力に関するラプラス方程式の近似差分方程式を
　　　　　　　　　　ＳＯＲ法で解くときの最大反復回数
　　変数　NSTEPS -  計算打ち切りタイムステップ数
　　変数　RE  ----  レイノルズ数
　　変数　REI  ---  1/RE
　　変数　DT  ----  時間間隔
　　変数　DTI  ---  1/DT
　　変数　EPS  ---  反復法の許容最大誤差（収束判定条件）

　サブルーチン GRID の仕様

　　配列　Ｘ　----  格子点のＸ座標を記憶する配列
　　配列　Ｙ  ----　格子点のＹ座標を記憶する配列
　　配列　RR  ----  だ円（ξ方向格子）の長径の長さを記憶する配列
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　ITYP  --  1:極座標のように１方向に周期的な座標を用いる場合
　　　　　　　　　　0:普通の座標系を用いる場合
　　変数　IGR  ---  1:格子をファイルから読む　0:だ円まわりの格子を生成
　　変数　IA,IB --  格子をファイルから読み込んだ場合のξ、η方向格子数
　　変数　AA,BB --  最内側（１番目、境界）のだ円の長径、短径
　　変数　HH,RA --  HHは２番目と１番目のだ円の長径の差、以後RA倍ごとに
　　　　　　　　　　差が大きくなる。（だ円の長径が長くなる）
　　変数　IOK  ---  1:計算続行　1以外:HH,RAを再入力する
　　変数　TT  ----  格子点の角座標
　　変数　AA,BC --  だ円の長径、短径
　　変数　JSAVE --  だ円格子をファイルに保存する(=1)、しない(1以外)

　サブルーチン METJ の仕様

　　配列　Ｘ　----  格子点のＸ座標を記憶する配列
　　配列　Ｙ  ----　格子点のＹ座標を記憶する配列
　　配列　XX,XY,YX,YY   それぞれξX,ξY,ηX,ηY を記憶する配列
　　配列　C1,･･,C5  Δ〇=C1*〇ξξ+C2*〇ξη+C3*〇ηη+C4*〇ξ+C5*〇η
　　　　　　　　　　と表したときの各係数を記憶する配列
　　配列　AJ  ----  変換のヤコビアンＪ
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　ITYP  --  1:極座標のように１方向に周期的な座標を用いる場合
　　　　　　　　　　0:普通の座標系を用いる場合
　　変数　XE,YE --  それぞれＸη、Ｙη
　　変数　XXI,YXI-  それぞれＸξ、Ｙξ
    変数　AJJ  ---  変換のヤコビアン

　サブルーチン INIT の仕様

　　配列　Ｕ　----  Ｘ方向の速度を記憶する配列
　　配列　Ｖ　----  Ｙ方向の速度を記憶する配列
　　配列　Ｐ　----  圧力を記憶する配列
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
    変数　ALP  ---  迎角（度）
    変数　TTT  ---  迎角（ラジアン）

　サブルーチン RHS  の仕様

　　配列　Ｕ　----  Ｘ方向の速度を記憶する配列
　　配列　Ｖ　----  Ｙ方向の速度を記憶する配列
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　DT  ----  時間間隔
　　変数　DTI  ---  1/DT
　　変数　EPS  ---  反復法の許容最大誤差（収束判定条件）
　　変数　ERR　---  全格子点での流れ関数の最大相対誤差（BBの最大値）
　　変数　CONST --  圧力に関するポアソン方程式の近似差分方程式を
　　　　　　　　　　ＳＯＲ法で解くときの加速係数
    変数　UXD  ---  ∂Ｕ／∂Ｘ
    変数　UYD  ---  ∂Ｕ／∂Ｙ
    変数　VXD  ---  ∂Ｖ／∂Ｘ
    変数　VYD  ---  ∂Ｖ／∂Ｙ

　サブルーチン PRSBC  の仕様

　　配列　Ｕ　----  Ｘ方向の速度を記憶する配列
　　配列　Ｖ　----  Ｙ方向の速度を記憶する配列
　　配列　Ｐ　----  圧力を記憶する配列
　　配列　XX,XY,YX,YY   それぞれξX,ξY,ηX,ηY を記憶する配列
　　配列　C1,･･,C5  Δ〇=C1*〇ξξ+C2*〇ξη+C3*〇ηη+C4*〇ξ+C5*〇η
　　　　　　　　　　と表したときの各係数を記憶する配列
　　配列　AJ  ----  変換のヤコビアンＪ
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　RE  ----  レイノルズ数
　　変数　REI  ---  1/RE
　　変数　UL,VL --  壁面上のラプラシアンの計算に用いる

　サブルーチン PRS  の仕様

　　配列　Ｐ　----  圧力を記憶する配列
　　配列　Ｑ　----  ポアソン方程式の右辺を記憶する配列
　　配列　C1,･･,C5  Δ〇=C1*〇ξξ+C2*〇ξη+C3*〇ηη+C4*〇ξ+C5*〇η
　　　　　　　　　　と表したときの各係数を記憶する配列
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　CONST --  圧力に関するポアソン方程式の近似差分方程式を
　　　　　　　　　　ＳＯＲ法で解くときの加速係数
　　変数　CC  ----  0.5/(C1+C3)
    変数  PA  ----  ポアソン方程式の近似差分方程式でＰi,j 含まない項
    変数  PP  ----  ポアソン方程式の近似差分方程式をＰi,j について
　　　　　　　　　　解いた式（右辺）

　サブルーチン NS  の仕様

　　配列　Ｕ　----  Ｘ方向の速度を記憶する配列
　　配列　Ｖ　----  Ｙ方向の速度を記憶する配列
　　配列　Ｐ　----  圧力を記憶する配列
　　配列　XX,XY,YX,YY   それぞれξX,ξY,ηX,ηY を記憶する配列
　　配列　C1,･･,C5  Δ〇=C1*〇ξξ+C2*〇ξη+C3*〇ηη+C4*〇ξ+C5*〇η
　　　　　　　　　　と表したときの各係数を記憶する配列
　　配列　AJ  ----  変換のヤコビアンＪ
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　RE  ----  レイノルズ数
　　変数　REI  ---  1/RE
　　変数　DT  ----  時間間隔
　　変数　DTI  ---  1/DT
　　変数　UNL  ---  Ｕに関する運動方程式の非線形項
　　変数　VNL  ---  Ｖに関する運動方程式の非線形項
　　変数　UVS  ---  Ｕに関する運動方程式の粘性項
　　変数　VVS  ---  Ｖに関する運動方程式の粘性項

　サブルーチン BC の仕様

　　配列　Ｕ　----  Ｘ方向の速度を記憶する配列
　　配列　Ｖ　----  Ｙ方向の速度を記憶する配列
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　TTT  ---  迎角（ラジアン）

　サブルーチン OUTP の仕様

　　配列　Ｕ　----  Ｘ方向の速度を記憶する配列
　　配列　Ｖ　----  Ｙ方向の速度を記憶する配列
　　配列　Ｐ　----  圧力を記憶する配列
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数

　サブルーチン OUT2 の仕様

　　配列　Ｘ　----  格子点のＸ座標を記憶する配列
　　配列　Ｙ  ----　格子点のＹ座標を記憶する配列
　　配列　Ｕ　----  Ｘ方向の速度を記憶する配列
　　配列　Ｖ　----  Ｙ方向の速度を記憶する配列
　　配列　Ｐ　----  表示する物理量（流れ関数）を記憶する配列
　　配列　INDEX --  表示する物理量を規格化し２桁の整数にして記憶する配列
　　配列　Ｚ　----  INDEX の偶奇によって文字を割当てて記憶する配列
　　関数　AREA ---  (P1,Q1),(P2,Q2),(P3,Q3) でできる三角形の面積の２倍を
　　　　　　　　　　計算する関数
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　PMIN,PMAX Ｐの最小値、最大値
　　変数　XA,YA --  表示したい点の座標
　　変数　X1,･･,Y4  ある格子を構成する４つの格子点の座標
　　変数　SA,SB --  格子を２つの三角形に分けたときのそれぞれの面積
　　　　　　　　　　（の２倍）
　　変数　S1,･･,S4  表示したい点と２つの格子点でできる三角形の面積
　　　　　　　　　　（の２倍）
　　変数　F1,･･,F4  表示したい点の物理量を近くの格子点から補間する
　　　　　　　　　　ときに用いる係数。
　　変数　IND ----  表示したい物理量を規格化して何倍かした量

