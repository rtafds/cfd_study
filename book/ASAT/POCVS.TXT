＜Ｃａｖｉｔｙ問題、ψ−ω法　−−−定常解＞

　このプログラムはＣａｖｉｔｙ流れを定常問題に対する流れ関数−渦度法を用いて計算するプログラムであり、本文の手続きをそのままプログラムしたものである。配列PSI、OMGはそれぞれψ、ωを表す。プログラムのはじめの部分でｘ方向の格子数NN（ｙ方向も同数）、レイノルズ数RE、最大反復回数NMAX、反復法の加速係数CONST1、CONST2、反復法の収束判定条件に用いるEPS1、EPS2を読み込む。なお反復法は次の条件が成立したとき、収束したとみなした。
　　max｜ψ(υ+1)j,k −ψ(υ)j,k｜≦EPS1
    max｜ω(υ+1)j,k −ω(υ)j,k｜≦EPS2
  DO 10 のループで反復法の出発値を０とおいたが、例えばレイノルズ数を変化させて複数の計算を行う場合には、あるケースの収束値を次のケースの出発値にとることにより収束を速めることができる。DO 100のループでψ、ωの反復計算を行う。DO 20、DO 30のループは(3.18)を用いて壁面上のωを内部のψを用いて変化させる境界条件の部分であり、反復過程でψが変化するためDO 100のループの内側にいれておく必要がある。なお境界上のψの値は常に０で変化しないため、DO 10 のループで初期条件を兼ねて一度与えておけば十分である。したがって境界条件としては改めて課していない。DO 40 のループで(3.20)、DO 60 のループで(3.19)を計算する。収束の判定はDO 50、DO 70のループで行っている。出力結果の表示はサブルーチンOUT で行っている。

　メインプログラムの仕様

　　配列　PSI ----  流れ関数ψを記憶する配列
　　配列　OMG ----  渦度ωを記憶する配列
　　配列　TMP ----  流れ関数や渦度ωを一時的に記憶する配列
　　変数　MX,MY --  プログラムの配列の大きさを指定するパラメータ
　　変数　NA  ----  格子数（Ｘ、Ｙ方向同数）
　　変数　NN  ----  格子点数（Ｘ、Ｙ方向同数）
　　変数　RE  ----  レイノルズ数
　　変数　NMAX ---  差分方程式（連立代数方程式）を反復法で解く時の
　　　　　　　　　　最大反復回数
　　変数　CONST1 -  渦度に関する方程式をＳＯＲ法で解くときの加速係数
　　変数　CONST2 -  流れ関数に関する方程式をＳＯＲ法で解くときの加速係数
　　変数　EPS  ---  反復法の許容最大誤差（収束判定条件）
　　変数　H   ----  格子幅
　　変数　HI   ---  １／（格子幅）
　　変数　AA  ----  ある格子点の前のステップでの渦度または流れ関数
　　変数　BB  ----  ある格子点での渦度または流れ関数の相対誤差
　　変数　ERR1 ---  全格子点での渦度の最大相対誤差（BBの最大値）
　　変数　ERR2 ---  全格子点での流れ関数の最大相対誤差（BBの最大値）

　サブルーチン　OUT の仕様（ラプラス方程式の解法(LAP.FOR)と同じ）

