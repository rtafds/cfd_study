＜拡大管内の流れ＞

　このプログラムは拡大管内の流れの解析など、一般座標系で表現された流れ関数−渦度法による流れの解析プログラムである。
　プログラムの多くの部分はプログラムPOTEN.FOR と共通になる。なぜなら渦度が０に固定されている場合(6.31)は一般座標で表現されたラプラス方程式となるからである。したがってプログラムPOTEN.FOR においてラプラス方程式をポアソン方程式に書き換え、渦度輸送方程式の部分を付け加えた上で、これら二つの方程式を各時間ステップごとに解くようにDOループで繰り返せば、流れ関数−渦度法のプログラムとなる。
　パラメータや配列、そしてサブルーチンの名前の多くはプログラムPOTEN.FOR と共通にしている。JMAX、KMAXはＸ、Ｙ方向の格子数、ISTEP0はポアソン方程式の反復回数、 CONSTはそのときの加速係数で EPSは収束判定に用いる。NSTEPSは最大タイムステップ数、REはレイノルズ数である。サブルーチン GRID、MET1 はプログラムPOTEN.FOR と全く同じで、またサブルーチン DATA で計算に必要なデータを読み込む。サブルーチン INIT2は初期条件であり、Ｘ方向に大きさ１の一様流を与えている。DO 40 のループで一つタイムステップを構成する。まず、DO 50 でψのポアソン方程式を解いたあと、サブルーチン OMEGAで渦度輸送方程式を(6.34)にしたがって１タイムステップ時間発展させる。サブルーチン BC2で境界条件を課す。サブルーチンOUTPでデータをファイルに書き出し、サブルーチン OUT2 で結果の簡単な表示を行う。
　なおこのプログラムは一般座標でかかれているため、格子点座標Ｘ、Ｙを指定していろいろな形状の流れを計算することができる。もちろん各問題ごとに境界条件を変化させる必要がある。例えば円柱まわりの流れのように一つの格子に沿って周期的である場合には周期条件を課す必要がある。その場合、方程式の係数も周期的にする必要がある。（テストデータとしてだ円柱まわりのポテンシャル流れを作成するようになっている。）

　メインプログラムの仕様

　　変数　ISTEP0 -  圧力に関するポアソン方程式の近似差分方程式を
　　　　　　　　　　ＳＯＲ法で解くときの最大反復回数
　　変数　NSTEPS -  計算打ち切りタイムステップ数
　　変数　EPS  ---  反復法の許容最大誤差（収束判定条件）
　　変数　ERR　---  全格子点での流れ関数の最大相対誤差（BBの最大値）
　　変数　CONST --  流れ関数に関するポアソン方程式の近似差分方程式を
　　　　　　　　　　ＳＯＲ法で解くときの加速係数

　サブルーチン DATA の仕様

　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　ISTEP0 -  圧力に関するラプラス方程式の近似差分方程式を
　　　　　　　　　　ＳＯＲ法で解くときの最大反復回数
　　変数　NSTEPS -  計算打ち切りタイムステップ数
　　変数　RE  ----  レイノルズ数
　　変数　REI  ---  1/RE
　　変数　DT  ----  時間間隔
　　変数　DTI  ---  1/DT
　　変数　EPS  ---  反復法の許容最大誤差（収束判定条件）

　サブルーチン GRID の仕様

　　配列　Ｘ　----  格子点のＸ座標を記憶する配列
　　配列　Ｙ  ----　格子点のＹ座標を記憶する配列
　　配列　RR  ----  だ円（ξ方向格子）の長径の長さを記憶する配列
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　ITYP  --  1:極座標のように１方向に周期的な座標を用いる場合
　　　　　　　　　　0:普通の座標系を用いる場合
　　変数　IGR  ---  1:格子をファイルから読む　0:だ円まわりの格子を生成
　　変数　IA,IB --  格子をファイルから読み込んだ場合のξ、η方向格子数
　　変数　AA,BB --  最内側（１番目、境界）のだ円の長径、短径
　　変数　HH,RA --  HHは２番目と１番目のだ円の長径の差、以後RA倍ごとに
　　　　　　　　　　差が大きくなる。（だ円の長径が長くなる）
　　変数　IOK  ---  1:計算続行　1以外:HH,RAを再入力する
　　変数　TT  ----  格子点の角座標
　　変数　AA,BC --  だ円の長径、短径
　　変数　JSAVE --  だ円格子をファイルに保存する(=1)、しない(1以外)

　サブルーチン METJ の仕様

　　配列　Ｘ　----  格子点のＸ座標を記憶する配列
　　配列　Ｙ  ----　格子点のＹ座標を記憶する配列
　　配列　XX,XY,YX,YY   それぞれξX,ξY,ηX,ηY を記憶する配列
　　配列　C1,･･,C5  Δ〇=C1*〇ξξ+C2*〇ξη+C3*〇ηη+C4*〇ξ+C5*〇η
　　　　　　　　　　と表したときの各係数を記憶する配列
　　配列　AJ  ----  変換のヤコビアンＪ
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　ITYP  --  1:極座標のように１方向に周期的な座標を用いる場合
　　　　　　　　　　0:普通の座標系を用いる場合
　　変数　XE,YE --  それぞれＸη、Ｙη
　　変数　XXI,YXI-  それぞれＸξ、Ｙξ
    変数　AJJ  ---  変換のヤコビアン

　サブルーチン INIT の仕様

　　配列　Ｙ  ----　格子点のＹ座標を記憶する配列
　　配列　Ｖ　----  渦度を記憶する配列
　　配列　Ｐ　----  流れ関数を記憶する配列
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数

　サブルーチン PSI  の仕様

　　配列　Ｐ　----  圧力を記憶する配列
　　配列　Ｖ　----  渦度を記憶する配列
　　配列　C1,･･,C5  Δ〇=C1*〇ξξ+C2*〇ξη+C3*〇ηη+C4*〇ξ+C5*〇η
　　　　　　　　　　と表したときの各係数を記憶する配列
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　CONST --  圧力に関するポアソン方程式の近似差分方程式を
　　　　　　　　　　ＳＯＲ法で解くときの加速係数
　　変数　CC  ----  0.5/(C1+C3)
    変数  PA  ----  ポアソン方程式の近似差分方程式でＰi,j 含まない項
    変数  PP  ----  ポアソン方程式の近似差分方程式をＰi,j について
　　　　　　　　　　解いた式（右辺）

　サブルーチン OMEGA  の仕様

　　配列　Ｖ　----  渦度を記憶する配列
　　配列　Ｐ　----  流れ関数を記憶する配列
　　配列　Ｄ　----  渦度を一時的に記憶する配列
　　配列　XX,XY,YX,YY   それぞれξX,ξY,ηX,ηY を記憶する配列
　　配列　C1,･･,C5  Δ〇=C1*〇ξξ+C2*〇ξη+C3*〇ηη+C4*〇ξ+C5*〇η
　　　　　　　　　　と表したときの各係数を記憶する配列
　　配列　AJ  ----  変換のヤコビアンＪ
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　RE  ----  レイノルズ数
　　変数　REI  ---  1/RE
　　変数　DT  ----  時間間隔
　　変数　DTI  ---  1/DT
　　変数　UNL  ---  渦度輸送方程式の非線形項
　　変数　VVS  ---  渦度輸送方程式の粘性項

　サブルーチン BC の仕様

　　配列　Ｖ　----  渦度を記憶する配列
　　配列　Ｐ　----  流れ関数を記憶する配列
　　配列　C1,･･,C5  Δ〇=C1*〇ξξ+C2*〇ξη+C3*〇ηη+C4*〇ξ+C5*〇η
　　　　　　　　　　と表したときの各係数を記憶する配列
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　JM,KM --  JM=JMAX-1, KM=KMAX-1
　　変数　ITYP  --  1:極座標のように１方向に周期的な座標を用いる場合
　　　　　　　　　　0:普通の座標系を用いる場合
　　変数　IGR  ---  1:格子をファイルから読む　0:だ円まわりの格子を生成

　サブルーチン OUTP の仕様

　　配列　Ｐ　----  流れ関数を記憶する配列
　　配列　Ｖ　----  渦度を記憶する配列
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数

　サブルーチン OUT2 の仕様

　　配列　Ｘ　----  格子点のＸ座標を記憶する配列
　　配列　Ｙ  ----　格子点のＹ座標を記憶する配列
　　配列　Ｐ　----  表示する物理量（流れ関数）を記憶する配列
　　配列　INDEX --  表示する物理量を規格化し２桁の整数にして記憶する配列
　　配列　Ｚ　----  INDEX の偶奇によって文字を割当てて記憶する配列
　　関数　AREA ---  (P1,Q1),(P2,Q2),(P3,Q3) でできる三角形の面積の２倍を
　　　　　　　　　　計算する関数
　　変数　JDIM,KDIM プログラムの配列の大きさを指定するパラメータ
　　変数　JMAX,KMAX ξ、η方向の格子点数
　　変数　PMIN,PMAX Ｐの最小値、最大値
　　変数　XA,YA --  表示したい点の座標
　　変数　X1,･･,Y4  ある格子を構成する４つの格子点の座標
　　変数　SA,SB --  格子を２つの三角形に分けたときのそれぞれの面積
　　　　　　　　　　（の２倍）
　　変数　S1,･･,S4  表示したい点と２つの格子点でできる三角形の面積
　　　　　　　　　　（の２倍）
　　変数　F1,･･,F4  表示したい点の物理量を近くの格子点から補間する
　　　　　　　　　　ときに用いる係数。
　　変数　IND ----  表示したい物理量を規格化して何倍かした量

