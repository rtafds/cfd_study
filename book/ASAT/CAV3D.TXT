プログラムＣＡＶ３Ｄ．ＦＯＲ

このプログラムは３次元の立方体形状の空洞（キャビティ）内の流れを計算するプログラムである。プログラム内のコメント文を読めばおおよそ何を行っているのか検討がつくと思われるが簡単に説明すると以下のようになる。
　はじめに計算に用いる配列を確保したのち、READ文で計算に必要なパラメータの読み込み（入力例はWRITE 文に記されている）、計算に使う変数の計算を行う。次にDO 20 のループで速度と圧力の初期条件を与える。このプログラムではすべて０においている。
　DO 30 のループが時間発展的に基礎方程式を解いていくＭＡＣ法の時間発展の大きなループを構成する。DO 40, DO 41, DO 43 の各ループで速度に関する境界条件を与えている。特にDO 43 の下半分が可動壁面での条件で斜めに動く場合も考慮されている（θ＝０が普通のキャビティ問題である）。DO 22 のループで圧力のポアソン方程式の右辺（ソース項）を計算している。
　DO 23 のループで圧力のポアソン方程式をガウスーザイデル法で解いている。圧力に関して境界条件はノイマン型になるため、境界での圧力は反復のたび毎に修正する必要がある。したがってDO 23 のループのなかに圧力の境界条件を入れている。境界条件は圧力勾配が０という条件にしているが、レイノルズ数が低い場合には速度の２階微分を含んだ関係式におきかえる必要がある。たとえば、壁面がｙ軸に平行な場合には
　　　∂ｐ／∂ｘ＝(1／Re) ∂／∂ｘ（∂ｕ／∂ｘ）
を差分近似した式から決める。DO 26 のループで圧力の１回の反復を構成する。修正量の二乗和が0.001 以下になったとき反復のループを抜けるほかに反復が一定回数を越しても次の時間ステップに進むようになっている。
　DO 27 のループではナビエ・ストークス方程式を用いて速度を時間発展させている。正確には左辺のU,V,W に対しては別の配列を用意して全格子点での計算が終ってからU,V,W に置き換える必要があるが、ここではガウス・ザイデル法のように計算してもあまり結果は変わらない（むしろ定常解には速く到達する）と考えてこのようにしている。
  DO 28 以下は計算には直接関係ない結果の表示の部分である。すなわちある断面内の速度を用いて２次元の流れ関数にあたるもの（３次元計算なので本来は存在しない）を計算するサブルーチンを呼び出し、それを近似的な等高線表示のためのサブルーチンを用いて表示する。
　サブルーチンPSI では速度U から流れ関数を計算する。主プログラムではスタガード格子を用いているため、このプログラムは不正確であるが、もともと流れ関数は存在せず参考のための出力に使うだけなのでため、あまり厳密なことは考えていない。
　サブルーチンOUT はFORTRAN のWRITE 文だけで簡単な等高線表示するプログラムである。

　メインプログラムの仕様
　配列
　　Ｕ　　　Ｘ方向の速度成分を記憶する配列
　　Ｖ　　　Ｙ方向の速度成分を記憶する配列
　　Ｗ　　　Ｚ方向の速度成分を記憶する配列
　　Ｐ　　　圧力を記憶する配列
　　Ｑ　　　ポアソン方程式の右辺を記憶する配列
　　Ｒ　　　流れ関数を記憶する配列
　変数
　　MX　　　Ｘ方向の最大の格子数
    MY　　　Ｙ方向の最大の格子数
    MZ　　　Ｚ方向の最大の格子数
    I20　   Ｘ方向の実際の格子数（入力データ）
    J20     Ｙ方向の実際の格子数（入力データ）
    K20     Ｚ方向の実際の格子数（入力データ）
    DT      時間刻み幅　△ｔ
    RE　　　レイノルズ数
    TETA　　壁面の動く方向を示す角度(°) ０°の場合は普通のCavity Flow
    LM      計算終了のタイムステップ数
    I21     I20 + 1
    J21     J20 + 1
    K21     K20 + 1
    I19     I20 + 1
    J19     J20 + 1
    K19     K20 + 1
    TD      1/DT
    R1      1/RE
    KM      ポアソン方程式の反復回数
    TET     ラジアンで表示したTETA
    DX      Ｘ方向の刻み幅
    DY      Ｙ方向の刻み幅
    DZ      Ｚ方向の刻み幅
    XD      1/DX
    YD      1/DY
    ZD      1/DZ
    DIJK    ポアソン方程式を反復法で解くときに現れる式の係数
    U1,U2,U3  ｕのｘ，ｙ，ｚ微分
    V1,V2,V3  ｖのｘ，ｙ，ｚ微分
    W1,W2,W3  ｗのｘ，ｙ，ｚ微分
　　G1      誤差の二乗和
    PCOR    圧力の修正量
    UV      △ｕ　（ラプラシアン）
    VV      △ｖ　（ラプラシアン）
    WV      △ｗ　（ラプラシアン）
    UN      ｕに対する方程式の非線形項
    VN      ｖに対する方程式の非線形項
    WN      ｗに対する方程式の非線形項
    ISAVE   データを保存する場合は１　しない場合は０

　サブルーチン　PSI の仕様
    配列
    U　　　 速度を記憶する配列
    R　　　 流れ関数を記憶する配列
　　変数
　　NX      ｘ方向の最大の格子数
    NY      ｙ方向の最大の格子数
    I21     ｘ方向の実際の格子数
    J21     ｙ方向の実際の格子数

　サブルーチン　OUT の仕様
　　流体解析Ｉ参照

