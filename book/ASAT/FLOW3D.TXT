
　プログラム　ＦＬＯＷ３Ｄ．ＦＯＲ

　このプログラムは一般座標系で表現された三次元非圧縮性粘性流体の流れの解析プログラムである。プログラムでは傾斜円柱まわりの流れを計算することを想定しており、そのための格子をプログラム内で生成している。もちろん、格子データを入力すればいろいろな流れが計算できる。ただしその場合、境界条件は適宜変更する必要がある。傾斜円柱まわりの格子は断面（端板に平行な面）が楕円になるため、楕円まわりの格子を式の形で与えて生成したのち、それを斜め方向に積み重ねて傾斜円柱まわりの格子にしている。
　プログラムの基本的な構成は主プログラムを見ればおおよそ検討がつくと思われるが以下に簡単に説明する。
　サブルーチン EDATAでは計算に必要なパラメータを直接読み込んだり、あるいはパラメータを計算したりする。サブルーチン GRID で格子データ（格子数と座標値）を読み込む。サブルーチン METJ では変換のヤコビアンおよび１階微分の変換に現れる係数を計算する。サブルーチン METJ2で変換されたラプラシアン(7.45)の係数を計算する。配列 C1-C9は本文中の式(7.45)に対応する。サブルーチンINITで初期条件を与えたのち、サブルーチン BC で速度の境界条件を与える。
　以下ＭＡＣ法に従って方程式を解いて１つの時間ステップすすめるが、このことを指定された回数繰り返すのがDO 10 のループである。サブルーチンRHS で圧力のポアソンの右辺を計算し、サブルーチンPRS で圧力のポアソン方程式をノイマン条件のもとで解く。次にサブルーチンNSで新しい時間ステップでの速度を計算したあと、サブルーチンBCでその結果を境界条件に取り込む。またサブルーチンOUT で何ステップかおきに計算結果を表示する。計算結果をサブルーチンSDATA でファイルに出力する。サブルーチンOUT2は簡単な計算結果表示プログラムであり、DO 20 のLLのループで端板に平行な断面内の入力した場所（Lが軸方向の格子番号で、0を入力すると終了）において、Lが一定の２次元断面で流れ関数を計算し、それをFORTRANの命令で表示する。


　メインプログラムの仕様

　　変数　JD,KD,LD -  ｘ，ｙ，ｚ方向の最大格子数
　　変数　NL    ----  タイムステップ数
　　変数　ISV   ----  １ならば結果をファイルに出力する

　サブルーチン BC の仕様

　　配列　Ｕ　　----  ｘ方向の速度を記憶する配列
　　配列　Ｖ　　----  ｙ方向の速度を記憶する配列
　　配列　Ｗ　　----  ｚ方向の速度を記憶する配列
　　変数　JD,KD,LD -  ｘ，ｙ，ｚ方向の最大格子点数
　　変数　JM,KM,LM -  ｘ，ｙ，ｚ方向の実際の格子点数
　　変数　JM1   ----  JM-1
    変数　KM1   ----  KM-1
    変数　LM1   ----  LM-1
    変数　LFL   ----  境界条件の種類（0=粘着壁 1=滑り壁 2=周期条件）

　サブルーチン EDATA の仕様

　　変数　JM,KM,LM -  ｘ，ｙ，ｚ方向の実際の格子点数
　　変数　JM1   ----  JM-1　（ｘ方向の格子数）
    変数　KM1   ----  KM-1　（ｙ方向の格子数）
    変数　LM1   ----  LM-1　（ｚ方向の格子数）
　　変数　IL    ----　圧力のポアソン方程式の反復回数
　　変数　DT  　----  時間間隔
　　変数　RE　  ----  レイノルズ数
    変数　IW    ----  結果を出力する場合のタイムステップ数
　　変数　DTI   ----  1/DT
　　変数　REI   ----  1/RE
    変数　LFL   ----  境界条件の種類（0=粘着壁 1=滑り壁 2=周期条件）
　　変数　EPS　 ----  反復法の許容最大誤差（収束判定条件）
　　変数　CONST ----  圧力のポアソン方程式をＳＯＲ法で解く場合の加速係数

　サブルーチン GRID の仕様

　　配列　Ｘ  　----  格子点のｘ座標を記憶する配列
　　配列　Ｙ    ----　格子点のｙ座標を記憶する配列
　　配列　Ｚ    ----　格子点のｚ座標を記憶する配列
　　配列　RA    ----  だ円（ξ方向格子）の長径の長さを記憶する配列
    配列　ZQ    ----  傾斜円柱の軸方向の距離の計算に使う配列
　　変数　JD,KD,LD -  ｘ，ｙ，ｚ方向の最大格子数
　　変数　JM,KM,LM -  ｘ，ｙ，ｚ方向の実際の格子点数
　　変数　R     ----  R 倍ごとに径方向の格子幅が大きくなる。
    変数　W     ----  最外側の楕円の短径の長さ
　　変数　TET   ----  端板の法線ベクトルと円柱の軸のなす角度
　　変数　H     ----  円柱の高さ
　　変数　TE    ----  TET をラジアンで表現した角度
　　変数　PAI   ----  円周率
　　変数　A     ----  最内側の径方向の格子幅
　　変数　IGTY  ----  軸方向の格子の種類（1=等間隔  0=不等間隔）
    変数　BB    ----  不等間隔格子の場合の格子の集中度

　サブルーチン INIT の仕様

　　配列　Ｕ　　----  Ｘ方向の速度を記憶する配列
　　配列　Ｖ　　----  Ｙ方向の速度を記憶する配列
　　配列　Ｗ　　----  Ｚ方向の速度を記憶する配列
　　配列　Ｐ　　----  圧力を記憶する配列
　　配列　XX,XY,XZ -  それぞれξx,ξy,ξzを記憶する配列
　　配列　YX,YY,YZ -  それぞれηx,ηy,ηzを記憶する配列
　　配列　ZX,ZY,ZZ -  それぞれζx,ζy,ζzを記憶する配列
    変数　PMIN  ----  圧力の最小値
　　変数　JD,KD,LD -  ｘ，ｙ，ｚ方向の最大格子数
　　変数　JM,KM,LM -  ｘ，ｙ，ｚ方向の実際の格子点数

　サブルーチン METJ の仕様

　　配列　Ｘ　  ----  格子点のｘ座標を記憶する配列
　　配列　Ｙ    ----　格子点のｙ座標を記憶する配列
　　配列　Ｚ    ----　格子点のｚ座標を記憶する配列
　　配列　XX,XY,XZ -  それぞれξx,ξy,ξzを記憶する配列
　　配列　YX,YY,YZ -  それぞれηx,ηy,ηzを記憶する配列
　　配列　ZX,ZY,ZZ -  それぞれζx,ζy,ζzを記憶する配列
　　配列　Ｑ    ----  変換のヤコビアンＪ
    配列　XJ,YJ,ZJ -  それぞれｘ，ｙ，ｚのξ方向微分
    配列　XK,YK,ZK -  それぞれｘ，ｙ，ｚのη方向微分
    配列　XL,YL,ZL -  それぞれｘ，ｙ，ｚのζ方向微分
　　変数　JD,KD,LD -  ｘ，ｙ，ｚ方向の最大格子数
　　変数　JM,KM,LM -  ｘ，ｙ，ｚ方向の実際の格子点数
　　変数　DX2   ----  計算面でのξ方向の格子幅の２倍
　　変数　DY2   ----  計算面でのη方向の格子幅の２倍
　　変数　DZ2   ----  計算面でのζ方向の格子幅の２倍

　サブルーチン METJ2 の仕様

　　配列　XX,XY,XZ -  それぞれξx,ξy,ξzを記憶する配列
　　配列　YX,YY,YZ -  それぞれηx,ηy,ηzを記憶する配列
　　配列　ZX,ZY,ZZ -  それぞれζx,ζy,ζzを記憶する配列
　　配列　C1,･･,C9 -  それぞれ本文(1.45)のC1,･･,C9に対応する配列
　　変数　JD,KD,LD -  ｘ，ｙ，ｚ方向の最大格子数
　　変数　JM,KM,LM -  ｘ，ｙ，ｚ方向の実際の格子点数
　　変数　JM1   ----  JM-1
    変数　KM1   ----  KM-1
    変数　LM1   ----  LM-1

　サブルーチン NS  の仕様

　　配列　Ｕ　　----  Ｘ方向の速度を記憶する配列
　　配列　Ｖ　　----  Ｙ方向の速度を記憶する配列
　　配列　Ｗ　　----  Ｚ方向の速度を記憶する配列
　　配列　Ｐ　　----  圧力を記憶する配列
　　配列　Ｄ　　----  Ｘ方向の速度を一時的に記憶する配列
　　配列　Ｑ　　----  Ｙ方向の速度を一時的に記憶する配列
　　配列　Ｓ　　----  Ｚ方向の速度を一時的に記憶する配列
　　配列　XX,XY,XZ -  それぞれξx,ξy,ξzを記憶する配列
　　配列　YX,YY,YZ -  それぞれηx,ηy,ηzを記憶する配列
　　配列　ZX,ZY,ZZ -  それぞれζx,ζy,ζzを記憶する配列
　　配列　C1,･･,C9 -  それぞれ本文(1.45)のC1,･･,C9に対応する配列
　　配列　US,VS,WS -  ξ，η，ζ方向の速度成分
　　配列　UA,VA,WA -  それぞれUS,VS,WSの絶対値
　　配列　UN    ----  ｕに関する方程式の非線形項
　　配列　VN    ----  ｖに関する方程式の非線形項
　　配列　WN    ----  ｗに関する方程式の非線形項
　　配列　UL    ----  ｕに関する方程式のラプラシアン
　　配列　VL    ----  ｖに関する方程式のラプラシアン
　　配列　WL    ----  ｗに関する方程式のラプラシアン
　　変数　JD,KD,LD -  ｘ，ｙ，ｚ方向の最大格子数
　　変数　JM,KM,LM -  ｘ，ｙ，ｚ方向の実際の格子点数
　　変数　JM1   ----  JM-1
    変数　KM1   ----  KM-1
    変数　LM1   ----  LM-1
　　変数　RE    ----  レイノルズ数
　　変数　REI    ---  1/RE
　　変数　DT    ----  時間間隔
　　変数　DTI    ---  1/DT
　　変数　PJ,PK,PL -  Ｐのξ，η，ζ方向微分
　　変数　UINC  ----  ｕの方程式を∂ｕ／∂ｔ＝・・の形に書いたときの右辺
　　変数　VINC  ----  ｖの方程式を∂ｖ／∂ｔ＝・・の形に書いたときの右辺
　　変数　WINC  ----  ｗの方程式を∂ｗ／∂ｔ＝・・の形に書いたときの右辺

　サブルーチン OUT の仕様

　　配列　Ｕ　　----  ｘ方向の速度を記憶する配列
　　配列　Ｖ　　----  ｙ方向の速度を記憶する配列
　　配列　Ｗ　　----  ｚ方向の速度を記憶する配列
　　配列　Ｐ　　----  圧力を記憶する配列
　　配列　LCN   ----  結果を出力するときの格子番号を指定する配列
　　変数　JD,KD,LD -  ｘ，ｙ，ｚ方向の最大格子点数
　　変数　JM,KM,LM -  ｘ，ｙ，ｚ方向の実際の格子点数

　サブルーチン PRS  の仕様

　　配列　Ｐ　　----  圧力を記憶する配列
　　配列　Ｑ　　----  ポアソン方程式の右辺を記憶する配列
　　配列　Ｓ　　----  ポアソン方程式を反復法で解くとき用いる配列
　　配列　XX,XY,XZ -  それぞれξx,ξy,ξz を記憶する配列
　　配列　YX,YY,YZ -  それぞれηx,ηy,ηzを記憶する配列
　　配列　ZX,ZY,ZZ -  それぞれζx,ζy,ζzを記憶する配列
　　配列　C1,･･,C9 -  それぞれ本文(1.45)のC1,･･,C9に対応する配列
　　変数　IL    ----  ポアソン方程式の反復回数
　　変数　JD,KD,LD -  ｘ，ｙ，ｚ方向の最大格子数
　　変数　JM,KM,LM -  ｘ，ｙ，ｚ方向の実際の格子点数
　　変数　JM1   ----  JM-1
    変数　KM1   ----  KM-1
    変数　LM1   ----  LM-1
　　変数　CONST 　--  圧力のポアソン方程式のＳＯＲ法で解くときの加速係数
    変数  PA　  ----  圧力の修正量
　　変数　GOSA  ----  反復法の誤差
　　変数　NC    ----  時間ステップ数

　サブルーチン RHS  の仕様

　　配列　Ｕ　----  ｘ方向の速度を記憶する配列
　　配列　Ｖ　----  ｙ方向の速度を記憶する配列
　　配列　Ｗ　----  ｚ方向の速度を記憶する配列
　　配列　XX,XY,XZ -  それぞれξx,ξy,ξzを記憶する配列
　　配列　YX,YY,YZ -  それぞれηx,ηy,ηzを記憶する配列
　　配列　ZX,ZY,ZZ -  それぞれζx,ζy,ζzを記憶する配列
　　変数　JD,KD,LD -  ｘ，ｙ，ｚ方向の最大格子数
　　変数　JM,KM,LM -  ｘ，ｙ，ｚ方向の実際の格子点数
　　変数　JM1   ----  JM-1
    変数　KM1   ----  KM-1
    変数　LM1   ----  LM-1
　　変数　DT  ----  時間間隔
　　変数　DTI  ---  1/DT
　　変数　UJ,UK,UL -  Ｕのξ，η，ζ方向微分
　　変数　VJ,VK,VL -  Ｖのξ，η，ζ方向微分
　　変数　WJ,WK,WL -  Ｗのξ，η，ζ方向微分
　　変数　UX,UY,UZ -  Ｕのｘ，ｙ，ｚ方向微分
　　変数　VX,VY,VZ -  Ｖのｘ，ｙ，ｚ方向微分
　　変数　WX,WY,WZ -  Ｗのｘ，ｙ，ｚ方向微分

　サブルーチン SDATA の仕様

　　配列　Ｘ　----  格子点のｘ座標を記憶する配列
　　配列　Ｙ  ----　格子点のｙ座標を記憶する配列
　　配列　Ｚ  ----　格子点のｚ座標を記憶する配列
　　配列　Ｕ　----  ｘ方向の速度を記憶する配列
　　配列　Ｖ　----  ｙ方向の速度を記憶する配列
　　配列　Ｗ　----  ｚ方向の速度を記憶する配列
　　配列　Ｐ　----  表示する物理量（流れ関数）を記憶する配列
　　変数　JD,KD,LD -  ｘ，ｙ，ｚ方向の最大格子点数
　　変数　JM,KM,LM -  ｘ，ｙ，ｚ方向の実際の格子点数


　サブルーチン OUT2 の仕様

　　配列　Ｘ　----  格子点のＸ座標を記憶する配列
　　配列　Ｙ  ----　格子点のＹ座標を記憶する配列
　　配列　Ｙ  ----　格子点のＹ座標を記憶する配列
　　配列　Ｕ　----  Ｘ方向の速度を記憶する配列
　　配列　Ｖ　----  Ｙ方向の速度を記憶する配列
　　配列　Ｗ　----  Ｙ方向の速度を記憶する配列
　　配列　ＰＰ----  表示する物理量（流れ関数）を記憶する配列
　　配列　INDEX --  表示する物理量を規格化し２桁の整数にして記憶する配列
　　配列　ＺＡ----  INDEX の偶奇によって文字を割当てて記憶する配列
　　関数　AREA ---  (P1,Q1),(P2,Q2),(P3,Q3) でできる三角形の面積の２倍を
　　　　　　　　　　計算する関数
　　変数　JD,KD,LD プログラムの配列の大きさを指定するパラメータ
　　変数　JM,KM 　　ξ、η方向の格子点数
　　変数　PMIN,PMAX ＰＰの最小値、最大値
　　変数　XA,YA --  表示したい点の座標
　　変数　X1,･･,Y4  ある格子を構成する４つの格子点の座標
　　変数　SA,SB --  格子を２つの三角形に分けたときのそれぞれの面積
　　　　　　　　　　（の２倍）
　　変数　S1,･･,S4  表示したい点と２つの格子点でできる三角形の面積
　　　　　　　　　　（の２倍）
　　変数　F1,･･,F4  表示したい点の物理量を近くの格子点から補間する
　　　　　　　　　　ときに用いる係数。
　　変数　IND ----  表示したい物理量を規格化して何倍かした量


