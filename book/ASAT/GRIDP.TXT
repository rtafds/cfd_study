＜ポアソン方程式による格子生成＞

　このプログラムはポアソン方程式(5.84)、(5.85)によって図5.22のだ円と円で囲まれた領域にＯ型格子を生成するプログラムである。配列Ｘ、Ｙ、Ｐ、Ｑはｘ、ｙ座標およびポアソン方程式（変換後の方程式は(5.86)）の右辺である。DO 10、DO 20のループにおいて初期格子を生成している。サブルーチンELLIPでだ円型の格子生成を行う。そのあと DO 23  のループで格子点の座標をファイルに格納する。コメントPLOTのあとはCALCOMP 系のグラフィックルーチンを用いて計算結果を図形表示するプログラムであるが、専用ライブラリが必要となるためすべて  CALL文はコメント文にしている。
　ITYPで格子をどのように集中させるかを指定する。ITYP＝０と選ぶとDO 30 のループでＰ＝Ｑ＝０となり、格子は集中しない（ラプラス方程式）。
　次にITYP＝１と選ぶとDO 40 のループで　

　Ｑ＝０、
　Ｐ＝−ａ sgn（Ｋ−Ｋ0）EXP（-Ｃ((Ｋ−Ｋ0)**2＋(Ｌ−Ｌ0)**2)）

となり、点（Ｋ0，Ｌ0）にξ方向から格子が集中する。なお集中の強さａ（AA）、減衰率Ｃ（cc）は入力する。
　ITYP＝２と選ぶとDO 50 のループで　

　Ｐ＝０、
　Ｑ＝−ａ sgn（Ｌ−Ｌ0）exp（−Ｃ｜Ｌ−Ｌ0｜）

となり、Ｌ＝Ｌ0 という格子線にηの両方向から近づくことになる。
　DO 120のループでだ円型方程式(5.105)、(5.106)を反復法で解いている。K100はＳＯＲ法の反復回数である。なおいずれの場合でも(5.105)、(5.106)は完全に収束させなくても滑らかな格子を得る目的には十分である。ＳＯＲ法の加速係数は反復の初期に非常に小さい値にしなければ(5.105)、(5.106)が収束しない場合が多い。したがってプログラムでは反復が進むにつれ１に近づけるようにしている。DO 120のループにおいて偏微分方程式を解く全体のループを構成している。DO 121 のループでＳＯＲ法の１回の反復を行った後に、DO 123 のループで周期境界条件を課している。なお内外の境界（壁面）では格子点は固定であるから、初期条件であらかじめ与えておけば以後改めて与える必要はない。計算結果の表示には図5.21に示した表示プログラムを用いる。

　メインプログラムの仕様

　　配列　Ｘ　----  格子点のＸ座標を記憶する配列
　　配列　Ｙ　----  格子点のＹ座標を記憶する配列
　　配列　Ｐ　----  ξのポアソン方程式の右辺（ソース項）を記憶する配列
　　配列　Ｑ　----  ηのポアソン方程式の右辺（ソース項）を記憶する配列
　　変数　MX,MY --  プログラムの配列の大きさを指定するパラメータ
　　変数　R1  ----　内部のだ円の半径
　　変数　R2  ----　外部の円の半径
　　変数　X3  ----　内外の円の中心間の距離
　　変数　PAI  ---  π
　　変数　R   ----　初期格子生成のときの境界間の円の半径
　　変数　TET ----　初期格子生成のときの境界間の円上の格子点の角座標

　サブルーチン　ELLIP の仕様

　　配列　Ｘ　----  格子点のＸ座標を記憶する配列
　　配列　Ｙ　----  格子点のＹ座標を記憶する配列
　　配列　Ｐ　----  ξのポアソン方程式の右辺（ソース項）を記憶する配列
　　配列　Ｑ　----  ηのポアソン方程式の右辺（ソース項）を記憶する配列
　　変数　IM,KM --  プログラムの配列の大きさを指定するパラメータ
    変数　K100 ---  格子に関するポアソン方程式の近似差分方程式を
　　　　　　　　　　ガウス−ザイデル法で解くときの最大反復回数
　　変数　ITYP ---  格子生成のタイプ　０：集中させない
　　　　　　　　　　１：指定点に集中させる　２：指定線に集中させる
　　変数　AA  ----  集中の強さを表すパラメータ
　　変数　CC  ----  減衰の大きさを表すパラメータ
　　変数　K4,L4 --  点（K4,L4） に格子を集中させる
　　変数　L3  ----　η＝L3に格子を集中させる
　　変数　SG  ----  ＫまたはＬの大小で１または−１をとる変数

